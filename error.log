{ message: 'Server failure status', level: 'error' }
{
  message: 'ValidationError: users validation failed: safes.0.files.0.notes: Cast to Number failed for value "notes1" (type string) at path "notes"\n' +
    '    at Document.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:3289:32)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1463:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1117:16)\n' +
    '    at EmbeddedDocument.Document (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:166:12)\n' +
    '    at EmbeddedDocument.Subdocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n' +
    '    at EmbeddedDocument.ArraySubdocument [as constructor] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n' +
    '    at new EmbeddedDocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\schema\\documentArray.js:127:17)\n' +
    '    at Proxy._cast (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\documentArray\\methods\\index.js:103:17)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ValidationError: users validation failed: safes.0.files.0.notes: Cast to Number failed for value "notes1" (type string) at path "notes"\n' +
    '    at Document.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:3289:32)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1463:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1117:16)\n' +
    '    at EmbeddedDocument.Document (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:166:12)\n' +
    '    at EmbeddedDocument.Subdocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n' +
    '    at EmbeddedDocument.ArraySubdocument [as constructor] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n' +
    '    at new EmbeddedDocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\schema\\documentArray.js:127:17)\n' +
    '    at Proxy._cast (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\documentArray\\methods\\index.js:103:17)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ValidationError: users validation failed: safes.0.files.0.notes: Cast to Number failed for value "notes1" (type string) at path "notes"\n' +
    '    at Document.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:3289:32)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at Subdocument.invalidate (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:229:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1463:12)\n' +
    '    at EmbeddedDocument.$set (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:1117:16)\n' +
    '    at EmbeddedDocument.Document (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\document.js:166:12)\n' +
    '    at EmbeddedDocument.Subdocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\subdocument.js:34:12)\n' +
    '    at EmbeddedDocument.ArraySubdocument [as constructor] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\arraySubdocument.js:44:15)\n' +
    '    at new EmbeddedDocument (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\schema\\documentArray.js:127:17)\n' +
    '    at Proxy._cast (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\types\\documentArray\\methods\\index.js:103:17)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:195:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:206:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at saveFileMetadata (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:19:19)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:73:31',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:131:18\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:131:18\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:209:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:209:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at saveFileMetadata (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:19:19)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:186:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\utils\\QueryUtil.js:10:17)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:209:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676cbe27067422d0e125ca8\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676cbe27067422d0e125ca8\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676cccf7067422d0e125cbc\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676cd2b7067422d0e125ccb\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:132:18\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:132:18\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676cd2b7067422d0e125ccb\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676ce2a7067422d0e125ce1\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676ce517067422d0e125cf0\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Failed to delete directory for safeId: 6676ce517067422d0e125cf0\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:155:27\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Promise.all (index 0)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\safeRouter.js:158:13',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at saveFileMetadata (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:19:19)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:74:31',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:281:27)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:304:26)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\sdam\\server.js:169:24)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:126:16)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\aggregation_cursor.js:46:26)\n' +
    '    at async [kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:454:27)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:514:13)\n' +
    '    at async [Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:160:34)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:273:26)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:281:27)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:304:26)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\sdam\\server.js:169:24)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:126:16)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\aggregation_cursor.js:46:26)\n' +
    '    at async [kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:454:27)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:514:13)\n' +
    '    at async [Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:160:34)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:273:26)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:281:27)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:304:26)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\sdam\\server.js:169:24)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:126:16)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\aggregation_cursor.js:46:26)\n' +
    '    at async [kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:454:27)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:514:13)\n' +
    '    at async [Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:160:34)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:273:26)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: query requires text score metadata, but it is not available\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ObjectParameterError: Parameter "filter" to find() must be an object, got "[object Object],[object Object],[object Object]" (type object)\n' +
    '    at model.Query.Query.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\query.js:2315:16)\n' +
    '    at Function.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\model.js:2269:13)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:272:39\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ObjectParameterError: Parameter "filter" to find() must be an object, got "[object Object],[object Object],[object Object]" (type object)\n' +
    '    at model.Query.Query.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\query.js:2315:16)\n' +
    '    at Function.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\model.js:2269:13)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:272:39\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ObjectParameterError: Parameter "filter" to find() must be an object, got "[object Object],[object Object],[object Object]" (type object)\n' +
    '    at model.Query.Query.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\query.js:2315:16)\n' +
    '    at Function.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\model.js:2269:13)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:272:39\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'ObjectParameterError: Parameter "filter" to find() must be an object, got "[object Object],[object Object],[object Object]" (type object)\n' +
    '    at Query.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\query.js:2315:16)\n' +
    '    at Function.find (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongoose\\lib\\model.js:2269:13)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\filesRouter.js:256:55\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\src\\utils\\QueryUtil.ts:11:15)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:243:23',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Cannot do inclusion on field fileName in exclusion projection\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Cannot do inclusion on field fileName in exclusion projection\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Cannot do inclusion on field fileName in exclusion projection\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Cannot do inclusion on field fileName in exclusion projection\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "MongoServerError: Invalid $project :: caused by :: FieldPath field names may not start with '$'. Consider using $getField or $setField.\n" +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: query requires text score metadata, but it is not available\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "MongoServerError: Invalid $project :: caused by :: FieldPath field names may not start with '$'. Consider using $getField or $setField.\n" +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Unknown expression $safes.files.fileName\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Unknown expression $safes.files.fileName\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "MongoServerError: Invalid $project :: caused by :: FieldPath field names may not start with '$'. Consider using $getField or $setField.\n" +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "MongoServerError: Invalid $project :: caused by :: FieldPath field names may not start with '$'. Consider using $getField or $setField.\n" +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "MongoServerError: Invalid $project :: caused by :: FieldPath field names may not start with '$'. Consider using $getField or $setField.\n" +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: query requires text score metadata, but it is not available\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: query requires text score metadata, but it is not available\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'toString')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:301:31\n' +
    '    at Array.forEach (<anonymous>)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:299:25\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'toString')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:301:31\n' +
    '    at Array.forEach (<anonymous>)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:299:25\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'name')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:302:28\n' +
    '    at Array.forEach (<anonymous>)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:299:25\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'toString')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:301:31\n' +
    '    at Array.forEach (<anonymous>)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:299:25\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'toString')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:308:37\n' +
    '    at Array.forEach (<anonymous>)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:306:25\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Path collision at safes.files\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: Invalid $project :: caused by :: Path collision at safes.files\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:498:17)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cmap\\connection.ts:562:22)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\sdam\\server.ts:310:16)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\operations\\execute_operation.ts:181:12)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\aggregation_cursor.ts:71:22)\n' +
    '    at async AggregationCursor.[kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:644:21)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:717:7)\n' +
    '    at async AggregationCursor.[Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:302:26)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\src\\cursor\\abstract_cursor.ts:438:22)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:159:12\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:159:12\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:159:12\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:159:12\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\src\\utils\\QueryUtil.ts:11:15)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:246:23',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at findFileById (C:\\Users\\fred_\\dev\\legacy-backend\\src\\utils\\QueryUtil.ts:11:15)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:246:23',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading '_id')\n" +
    '    at newSearchSafesResult (C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:26:23)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:111:34\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading '_id')\n" +
    '    at newSearchSafesResult (C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:26:23)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:111:34\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading '_id')\n" +
    '    at newSearchSafesResult (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:27:29)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:102:40\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading '_id')\n" +
    '    at newSearchSafesResult (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:27:29)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:102:40\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading '_id')\n" +
    '    at newSearchSafesResult (C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:27:29)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\dist\\src\\controllers\\searchRouter.js:102:40\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at saveFileMetadata (C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:24:15)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:90:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot read properties of undefined (reading 'files')\n" +
    '    at saveFileMetadata (C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:24:15)\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\filesRouter.ts:90:27',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:276:10)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:84:22\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at Function.process_params (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:421:3)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n' +
    '    at Function.handle (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:175:3)\n' +
    '    at router (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:47:12)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:276:10)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:84:22\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at Function.process_params (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:421:3)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n' +
    '    at Function.handle (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:175:3)\n' +
    '    at router (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:47:12)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:276:10)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:85:22\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at Function.process_params (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:421:3)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n' +
    '    at Function.handle (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:175:3)\n' +
    '    at router (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:47:12)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:276:10)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:84:22\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at Function.process_params (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:421:3)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n' +
    '    at Function.handle (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:175:3)\n' +
    '    at router (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:47:12)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:276:10)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:84:22\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:149:13)\n' +
    '    at Route.dispatch (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\route.js:119:3)\n' +
    '    at Layer.handle [as handle_request] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\layer.js:95:5)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:284:15\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:365:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at param (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:376:14)\n' +
    '    at Function.process_params (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:421:3)\n' +
    '    at next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:280:10)\n' +
    '    at Function.handle (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:175:3)\n' +
    '    at router (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\router\\index.js:47:12)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'Error: Cannot set headers after they are sent to the client\n' +
    '    at ServerResponse.setHeader (node:_http_outgoing:652:11)\n' +
    '    at ServerResponse.header (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:795:10)\n' +
    '    at ServerResponse.send (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:175:12)\n' +
    '    at ServerResponse.json (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\express\\lib\\response.js:279:15)\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\searchRouter.ts:86:22',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: "TypeError: Cannot set properties of undefined (setting 'name')\n" +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\safeRouter.ts:84:18\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'MongoServerError: $match with $text is only allowed as the first pipeline stage\n' +
    '    at Connection.sendCommand (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:281:27)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at async Connection.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cmap\\connection.js:304:26)\n' +
    '    at async Server.command (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\sdam\\server.js:169:24)\n' +
    '    at async executeOperation (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\operations\\execute_operation.js:126:16)\n' +
    '    at async AggregationCursor._initialize (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\aggregation_cursor.js:46:26)\n' +
    '    at async [kInit] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:454:27)\n' +
    '    at async next (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:514:13)\n' +
    '    at async [Symbol.asyncIterator] (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:160:34)\n' +
    '    at async AggregationCursor.toArray (C:\\Users\\fred_\\dev\\legacy-backend\\node_modules\\mongodb\\lib\\cursor\\abstract_cursor.js:273:26)',
  level: 'error'
}
{ message: 'Server failure status', level: 'error' }
{
  message: 'TypeError: shareTime.format is not a function\n' +
    '    at C:\\Users\\fred_\\dev\\legacy-backend\\src\\controllers\\userRouter.ts:105:23\n' +
    '    at processTicksAndRejections (node:internal/process/task_queues:95:5)',
  level: 'error'
}
